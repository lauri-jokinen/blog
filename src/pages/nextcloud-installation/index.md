---
title: Create your own cloud service
date: 2020-11-30T00:40:32+02:00
modified: 2021-08-18T17:46:26+03:00
tags: [cloud]
---

About a year ago I was on the verge of paying for a cloud service, and I looked into other options. Finally I decided to make my own cloud right at my home. Almost everyone has an old computer somewhere in their closets. Combine that with a decent internet connection, a router and a bit of work, and you’ll have your own cloud service!

I use Nextcloud which is an open source project with great functionality. In this [video] you can see what it can do. You might want to look into [Syncthing], [Filecoin] and [sia]. I also want to emphasize that this is only one way of doing a cloud - there are many ways to do each step. I’ve encountered many problems while hosting my cloud, and I hope that with this manual you’ll manage to avoid the same mistakes. If you have questions, ask me or consult your nearest geek.

All costs of this project come in your electricity bill. The idea is to have your old computer running day and night. It can sound expensive but, for example, my cloud costs about ten euros a year, which competes with any cloud service out there. The service is safe as long as no one steals your computer.

Why is it great to have your own cloud?
Keeping as much of your data away from big companies (like Google) is probably good.
You’ll reduce the load on datacenters. Some even claim that “the emissions generated by watching 30 minutes of Netflix (1.6 kg of CO2) is the same as driving almost four miles.” (https://energyinnovation.org/2020/03/17/how-much-energy-do-data-centers-really-use/) With Nextcloud you can stream videos and movies.
See my previous entry, ”Rant about using your electronics”.

## Requirements
Here’s what you’ll need:

* Computer that is able to run Ubuntu 18.04
or newer (or some other operating system that supports snap-packages)
* As much disk space as you want. You can combine multiple disks using RAID.
* Router with a port forwarding feature and a DHCP feature. Most of them do.
* Reliable (and snappy) internet connection.

## How a server works
This graph is very simple, but gives you an idea of the whole system. To be updated...

World

| URL (e.g. https://some.cloud.com)

Domain

| IP (usually 8x.xxx.xx)

Router

| IP (usually somethin like 192.168.1.52)

Host computer

{

Snap package

{

Apache (server program)

|

Nextcloud (website)

}

| SQL

Database on a hard drive

}

## Install Ubuntu

Install Ubuntu 18.04 or newer. With this operating system you can use your server as a regular computer too: maybe a livingroom computer or such. RAID and disk management is easy using the graphical interface. We’ll use 18.04 or newer because they support snap packages.

I recommend disabling all unnecessary connectivity (bluetooth etc.), since it can affect drivers etc. and make the computer more unstable. It did with mine.

If you’re a pro, you might want to install Ubuntu Server 18.04 (or newer) instead. It has no visual interface; just a command line. It’s more reliable, since it doesn’t require as many drivers as the regular Ubuntu 18.04. You can also create the cloud on a virtual machine if you want. There are good instructions online for these variants.


## Check few addresses
When you have your operating system set up, go to your internet settings and click on the wheel-icon. Take a note of your local IP address, it’s something like, 192.168.1.52. Also note the MAC-address, something like 74:D4:35:84:34:13. We need these addresses soon.

## Configure router
Next we’ll configure your router. We’re going to do two things: 
1. Port forwarding exposes your router to the world. After this step you can connect to your router from anywhere in the world.
2. DHCP retains the connection between your router and host computer. Router generates a local IP address for your host computer and it might vary (mine did about bi-mothly). With DHCP your router will keep the same IP for your host computer and the connection retains.

You can do these steps on any device, that is connected to the router (by the router’s wifi or by a cable).

Go to 192.168.1.1 with your browser. This address works on most of routers. You should see some sort of login page. When logged in, you should find and activate the Port Forwarding feature, and add two entries there,
* Port 80 with the local IP address
* Port 443 with the local IP address
You might be able to set names to these entries, and they can be whatever, like ’cloud’, or ’server’.

Next, find where you can set a DHCP-server on the router’s web page. Put there an entry with above MAC-address and local IP address.

Ok, now the router is done!

## Get a free domain
If you want a completely new domain, you’ll need to pay for it (around 15€/year). I recommend trying the cloud first with a free subdomain.

Go to
[freedns.afraid.org](https://freedns.afraid.org),
make yourself an account, and go to ’Registry’. Here you can, for example, choose ’crabdance.com’. Next you need to come up with a subdomain name, like ’wonderful’. Now your domain would be ’wonderful.crabdance.com’. You’ll want to choose a public domain rather than a private one, because the owner of the domain can delete your subdomain at any point. I’ve done this mistake in the past.

Once you find a domain and subdomain that suits you, select type A and put in the destination your _public_ IP address. You can actually just connect any device to the router and Google "what’s my ip", and Google will show you the public IP.

When you’re done, you should be able to connect to your router via this domain, from anywhere in the world. But at the moment you should see a 404 Not found -page.

## Install Nextcloud
Let’s go back to the server machine. Next we’ll install Nextcloud snap-package. There are other ways, but this is by far the easiest. Here’s a
<a href= "https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-nextcloud-on-ubuntu-18-04" target="_blank">link</a>.

Alfter installation you’ll want to configure SSL-connection woth Let’s Encrypt. It is built in to the snap, and requires just a few lines of code.

Manual installation is a bit of a hassle, and I recommend trying the snap package if you’re a starter. You might want to look at manual install if
* If you want to have more web pages on same host computer. With snap you can basically just use Nextcloud. If you already have a Nextcloud snap, don’t install Apache! Then that Apache will override the snap’s Apache.
* You want to configure Apache somehow, like redirect pages etc.
